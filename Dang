local UI = {}

local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SapiHub"
ScreenGui.IgnoreGuiInset = true
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = PlayerGui

local Blur = Instance.new("BlurEffect")
Blur.Size = 0
Blur.Parent = game.Lighting

local function blurOn()
    game:GetService("TweenService"):Create(Blur, TweenInfo.new(0.4, Enum.EasingStyle.Sine), {Size = 10}):Play()
end

local function blurOff()
    game:GetService("TweenService"):Create(Blur, TweenInfo.new(0.4, Enum.EasingStyle.Sine), {Size = 0}):Play()
end

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 380, 0, 260)
MainFrame.Position = UDim2.new(0.5, -190, 0.35, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.BackgroundTransparency = 0.15
MainFrame.Parent = ScreenGui

local Corner = Instance.new("UICorner")
Corner.CornerRadius = UDim.new(0, 12)
Corner.Parent = MainFrame

local Shadow = Instance.new("ImageLabel")
Shadow.Name = "Shadow"
Shadow.Parent = MainFrame
Shadow.AnchorPoint = Vector2.new(0.5, 0.5)
Shadow.Position = UDim2.new(0.5, 0, 0.5, 4)
Shadow.Size = UDim2.new(1, 30, 1, 30)
Shadow.BackgroundTransparency = 1
Shadow.Image = "rbxassetid://6015897843"
Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
Shadow.ImageTransparency = 0.45
Shadow.ScaleType = Enum.ScaleType.Slice
Shadow.SliceCenter = Rect.new(49, 49, 450, 450)

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(1, 0, 0, 42)
Title.BackgroundColor3 = Color3.fromRGB(255, 65, 65)
Title.Font = Enum.Font.GothamBold
Title.TextColor3 = Color3.new(1, 1, 1)
Title.TextScaled = true
Title.Text = "Sapi Hub | Auto Bounty"
Title.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 12)
TitleCorner.Parent = Title

local Message = Instance.new("TextLabel")
Message.Name = "Message"
Message.Parent = MainFrame
Message.Position = UDim2.new(0, 12, 0, 55)
Message.Size = UDim2.new(1, -24, 0, 35)
Message.BackgroundTransparency = 1
Message.TextColor3 = Color3.fromRGB(220, 220, 220)
Message.Font = Enum.Font.GothamSemibold
Message.TextScaled = true
Message.Text = "Waiting..."

local TargetListLabel = Instance.new("TextLabel")
TargetListLabel.Name = "TargetListLabel"
TargetListLabel.Parent = MainFrame
TargetListLabel.Position = UDim2.new(0, 12, 0, 95)
TargetListLabel.Size = UDim2.new(1, -24, 0, 35)
TargetListLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
TargetListLabel.TextColor3 = Color3.new(1, 1, 1)
TargetListLabel.TextScaled = true
TargetListLabel.Text = "Targets: none"

local TC1 = Instance.new("UICorner")
TC1.CornerRadius = UDim.new(0, 10)
TC1.Parent = TargetListLabel

function UI.UpdateTargetsList(list)
    if typeof(list) == "table" then
        TargetListLabel.Text = "Targets: " .. table.concat(list, ", ")
    else
        TargetListLabel.Text = "Targets: " .. tostring(list or "none")
    end
end

local CurrentTargetLabel = Instance.new("TextLabel")
CurrentTargetLabel.Name = "CurrentTargetLabel"
CurrentTargetLabel.Parent = MainFrame
CurrentTargetLabel.Position = UDim2.new(0, 12, 0, 135)
CurrentTargetLabel.Size = UDim2.new(1, -24, 0, 35)
CurrentTargetLabel.BackgroundColor3 = Color3.fromRGB(50, 120, 255)
CurrentTargetLabel.TextColor3 = Color3.new(1, 1, 1)
CurrentTargetLabel.TextScaled = true
CurrentTargetLabel.Text = "Current Target: none"

local TC2 = Instance.new("UICorner")
TC2.CornerRadius = UDim.new(0, 10)
TC2.Parent = CurrentTargetLabel

function UI.SetTarget(name)
    CurrentTargetLabel.Text = "Current Target: " .. tostring(name or "none")
end

local NotifyColors = {
    success = Color3.fromRGB(60, 200, 90),
    error   = Color3.fromRGB(220, 80, 80),
    warn    = Color3.fromRGB(240, 180, 70),
    info    = Color3.fromRGB(80, 170, 240),
}

function UI.ShowNotification(text, nType)
    nType = nType or "info"

    local Note = Instance.new("TextLabel")
    Note.Parent = MainFrame
    Note.Size = UDim2.new(1, -24, 0, 40)
    Note.Position = UDim2.new(0, 12, 0, 180)
    Note.BackgroundColor3 = NotifyColors[nType]
    Note.TextColor3 = Color3.new(1, 1, 1)
    Note.Font = Enum.Font.GothamMedium
    Note.TextScaled = true
    Note.Text = text

    local C = Instance.new("UICorner", Note)
    C.CornerRadius = UDim.new(0, 10)

    task.spawn(function()
        task.wait(2)
        for i = 1, 20 do
            Note.TextTransparency = i/20
            Note.BackgroundTransparency = i/20
            task.wait(0.03)
        end
        Note:Destroy()
    end)
end

local StatsFrame = Instance.new("Frame")
StatsFrame.Name = "StatsFrame"
StatsFrame.Parent = MainFrame
StatsFrame.Size = UDim2.new(1, -24, 0, 90)
StatsFrame.Position = UDim2.new(0, 12, 0, 225)
StatsFrame.BackgroundTransparency = 1

local EarnedLabel = Instance.new("TextLabel")
EarnedLabel.Name = "EarnedLabel"
EarnedLabel.Parent = StatsFrame
EarnedLabel.Size = UDim2.new(1, 0, 0, 25)
EarnedLabel.Position = UDim2.new(0, 0, 0, 0)
EarnedLabel.BackgroundTransparency = 0.3
EarnedLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
EarnedLabel.TextColor3 = Color3.new(1, 1, 1)
EarnedLabel.Font = Enum.Font.GothamMedium
EarnedLabel.TextScaled = true
EarnedLabel.Text = "Earned: 0"

local EC1 = Instance.new("UICorner")
EC1.CornerRadius = UDim.new(0, 8)
EC1.Parent = EarnedLabel

local TotalLabel = Instance.new("TextLabel")
TotalLabel.Name = "TotalLabel"
TotalLabel.Parent = StatsFrame
TotalLabel.Size = UDim2.new(1, 0, 0, 25)
TotalLabel.Position = UDim2.new(0, 0, 0, 30)
TotalLabel.BackgroundTransparency = 0.3
TotalLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
TotalLabel.TextColor3 = Color3.new(1, 1, 1)
TotalLabel.Font = Enum.Font.GothamMedium
TotalLabel.TextScaled = true
TotalLabel.Text = "Total Earned: 0"

local EC2 = Instance.new("UICorner")
EC2.CornerRadius = UDim.new(0, 8)
EC2.Parent = TotalLabel

local BountyLabel = Instance.new("TextLabel")
BountyLabel.Name = "BountyLabel"
BountyLabel.Parent = StatsFrame
BountyLabel.Size = UDim2.new(1, 0, 0, 25)
BountyLabel.Position = UDim2.new(0, 0, 0, 60)
BountyLabel.BackgroundTransparency = 0.3
BountyLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
BountyLabel.TextColor3 = Color3.new(1, 1, 1)
BountyLabel.Font = Enum.Font.GothamMedium
BountyLabel.TextScaled = true
BountyLabel.Text = "Bounty/Honor: 0"

local EC3 = Instance.new("UICorner")
EC3.CornerRadius = UDim.new(0, 8)
EC3.Parent = BountyLabel

function UI.UpdateStats(Earned, TotalEarned, Bounty)
    EarnedLabel.Text = "Earned: " .. tostring(Earned)
    TotalLabel.Text = "Total Earned: " .. tostring(TotalEarned)
    BountyLabel.Text = "Bounty/Honor: " .. tostring(Bounty)
end

-- DRAGGING SYSTEM
local UIS = game:GetService("UserInputService")
local dragging = false
local dragStart
local startPos

local function startDrag(input)
    dragging = true
    dragStart = input.Position
    startPos = MainFrame.Position

    input.Changed:Connect(function()
        if input.UserInputState == Enum.UserInputState.End then
            dragging = false
        end
    end)

    blurOn()
end

MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or 
       input.UserInputType == Enum.UserInputType.Touch then
        startDrag(input)
    end
end)

Title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or 
       input.UserInputType == Enum.UserInputType.Touch then
        startDrag(input)
    end
end)

UIS.InputChanged:Connect(function(input)
    if dragging then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)

MainFrame.InputEnded:Connect(function()
    blurOff()
end)

return UI
